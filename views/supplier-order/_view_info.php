<?php

/**
 * Autogenerated From GII
 * modified by Defri Indra M
 * 2021
 */

use app\components\annex\Tabs;
use yii\helpers\Html;
use yii\helpers\Url;
use yii\grid\GridView;
use yii\widgets\DetailView;

/**
 * @var yii\web\View $this
 * @var yii\data\ActiveDataProvider $dataProvider
 * @var app\models\search\SupplierPengirimanSearch $searchModel
 */
?>

<div class="card m-b-30">
    <div class="card-body">
        <?php $this->beginBlock('app\models\SupplierOrder'); ?>
        <div class="table-responsive">

            <?= DetailView::widget([
                'model' => $model,
                'attributes' => [
                    // modified by Defri Indra
                    [
                        'attribute' => 'Layanan Supplier',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->layanan_supplier == 0) :
                                return "Supplier Ritel";
                            else :
                                return "Supplier Proyek";
                            endif;
                        }
                    ],
                    [
                        'format' => 'html',
                        'attribute' => 'user_id',
                        'value' => ($model->user ? $model->user->name : '<span class="label label-warning">?</span>'),
                    ],
                    [
                        'attribute' => 'nama_penerima',
                        'format' => 'text',
                    ],
                    [
                        'attribute' => 'kode_unik',
                        'format' => 'text',
                    ],
                    [
                        'attribute' => 'no_nota',
                        'format' => 'text',
                    ],
                    [
                        'attribute' => 'Total Harga',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->total_harga) :
                                return \app\components\Angka::toReadableHarga($model->total_harga);
                            else :
                                return "-";
                            endif;
                        }
                    ],
                    [
                        'attribute' => 'Detail Order',
                        'format' => 'raw',
                        'value' => function ($model) {
                            return
                                Html::button('Lihat Detail Order', ['value' => Url::to(['supplier-order/detail?id=' . $model->id]), 'class' => 'btn btn-success modalButton', 'id' => 'modalButton']);
                        }
                    ],
                    [
                        'attribute' => 'Info Pembangunan',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->id_isian_lanjutan) :
                                return
                                    Html::button('Info Pembangunan', ['value' => Url::to(['supplier-order/detail-boq?id=' . $model->id_isian_lanjutan]), 'class' => 'btn btn-success modalButton2', 'id' => 'modalButton2']);
                            else :
                                return "-";
                            endif;
                        }
                    ],
                    [
                        'attribute' => 'Bukti Pembayaran',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->bukti_bayar) :
                                return Yii::$app->formatter->asDownload($model->bukti_bayar);
                            else :
                                return "-";
                            endif;
                        }
                    ],
                    [
                        'attribute' => 'tanggal_pembayaran',
                        'format' => 'raw',
                        'value' => function ($model) {
                            return Yii::$app->formatter->asDatetime($model->tanggal_bayar);
                        }
                    ],
                    [
                        'attribute' => 'Keterangan Pembayaran',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->keterangan_bayar) :
                                return $model->keterangan_bayar;
                            else :
                                return "-";
                            endif;
                        }
                    ],
                    [
                        'attribute' => 'status',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->status == 0) :
                                return "Belum Bayar";
                            elseif ($model->status == 1) :
                                return "Bayar (pengecekan)";
                            elseif ($model->status == 2) :
                                return "Lunas";
                            elseif ($model->status == 3) :
                                return "Pembayaran ditolak";
                            endif;
                        }
                    ],
                    [
                        'attribute' => 'Alasan Tolak',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->alasan_tolak) :
                                return $model->alasan_tolak;
                            else :
                                return "-";
                            endif;
                        }
                    ],
                    [
                        'attribute' => 'Bukti Diterima',
                        'format' => 'raw',
                        'value' => function ($model) {
                            if ($model->bukti_diterima) :
                                return Yii::$app->formatter->asDownload($model->bukti_diterima);
                            else :
                                return "-";
                            endif;
                        }
                    ],
                    [
                        'attribute' => 'keterangan_diterima',
                        'format' => 'text',
                    ],
                    // [
                    //     'attribute' => 'updated_at',
                    //     'format' => 'iddate',
                    // ],
                    // [
                    //     'attribute' => 'deleted_at',
                    //     'format' => 'iddate',
                    // ],
                    // [
                    //     'attribute' => 'created_by',
                    //     'format' => 'text',
                    // ],
                    // [
                    //     'attribute' => 'updated_by',
                    //     'format' => 'text',
                    // ],
                    // [
                    //     'attribute' => 'deleted_by',
                    //     'format' => 'text',
                    // ],
                    // [
                    //     'attribute' => 'flag',
                    //     'format' => 'boolean',
                    // ],
                ],
            ]); ?>
        </div>

        <hr />

        <?php Html::a(
            '<span class="glyphicon glyphicon-trash"></span> ' . 'Delete',
            ['delete', 'id' => $model->id],
            [
                'class' => 'btn btn-danger',
                'data-confirm' => '' . 'Are you sure to delete this item?' . '',
                'data-method' => 'post',
            ]
        ); ?>
        <?php $this->endBlock(); ?>



        <?= Tabs::widget(
            [
                'id' => 'relation-tabs',
                'encodeLabels' => false,
                'items' => [
                    [
                        'label'   => '<b class=""># ' . $model->id . '</b>',
                        'content' => $this->blocks['app\models\SupplierOrder'],
                        'active'  => true,
                    ],
                ]
            ]
        );
        ?>
    </div>
</div>