<?php

/**
 * Autogenerated From GII
 * modified by Defri Indra M
 * 2021
 */
// $cproduk = \app\models\ContohProduk::find()->one();

use yii\helpers\Html;
use app\components\annex\ActiveForm;
use \app\components\annex\Tabs;
use richardfan\widget\JSRegister;

/**
 * @var yii\web\View $this
 * @var app\models\DetailContohProduk $model
 * @var app\components\annex\ActiveForm $form
 */

?>

<?php $form = ActiveForm::begin([
    'id' => 'DetailContohProduk',
    'layout' => 'horizontal',
    'enableClientValidation' => true,
    'errorSummaryCssClass' => 'error-summary alert alert-error'
]);
?>
<?php echo $form->errorSummary($model); ?>

<div class="clearfix"></div>
<div class="d-flex  flex-wrap">
    <style>
        .marker {
            background-image: url("data:image/svg+xml,%3Csvg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='plus-circle' class='svg-inline--fa fa-plus-circle fa-w-16' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='yellow' d='M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z'%3E%3C/path%3E%3C/svg%3E");
        }
    </style>
    <?php JSRegister::begin(); ?>
    <script>
        $(document).ready(function() {
            $('.img-product').click(function(e) {
                var offset = $(this).offset();
                var getHeight = ($('.img-product').height());
                var getWidth = ($('.img-product').width());

                var X = Math.round((e.pageX - offset.left) / getWidth * 100);
                var Y = Math.round((e.pageY - offset.top) / getHeight * 100);
                $('#detailcontohproduk-x_pos').val(X);
                $('#detailcontohproduk-y_pos').val(Y);
                if ($('.marker').length < 9999) {
                    $(".marker").remove();
                    $(".img-product").append(
                        $('<div class="marker"></div>').css({
                            position: 'absolute',
                            top: Y + '%',
                            left: X + '%',
                            width: '25px',
                            height: '25px',
                        })
                    );
                }

            });
        });
    </script>
    <?php JSRegister::end(); ?>
    <div class="col-12">
        <div style="overflow-y: hidden;overflow-x: scroll;max-width: 100vw;">
            <div class="img-product" style="width: 100%; height: 780px;position:relative;border:1px solid #d3d3d3;background-image:url('<?= \Yii::$app->request->baseUrl . "/uploads/" . $cproduk->gambar ?>');background-position: center;background-repeat: no-repeat;background-size: cover;">
                <?php if ($model->y_pos != null && $model->x_pos != null) : ?>
                    <div class="marker" style="position: absolute; top: <?= $model->y_pos ?>%; left: <?= $model->x_pos ?>%; width: 25px; height: 25px;"></div>
                <?php endif; ?>
            </div>
        </div>
    </div>
    <?= $form->field($model, "id", \app\components\Constant::COLUMN(1))->hiddenInput()->label(false) ?>
    <?= $form->field($model, 'x_pos', \app\components\Constant::COLUMN(3))->textInput() ?>
    <?= $form->field($model, 'y_pos', \app\components\Constant::COLUMN(3))->textInput() ?>
    <?=         // modified by Defri Indra
    $form->field($model, 'id_supplier_barang', \app\components\Constant::COLUMN(3))->widget(\kartik\select2\Select2::classname(), [
        'name' => 'class_name',
        'model' => $model,
        'attribute' => 'id_supplier_barang',
        'data' => \yii\helpers\ArrayHelper::map(app\models\SupplierBarang::find()->all(), 'id', 'nama_barang'),
        'options' => [
            'placeholder' => $model->getAttributeLabel('id_supplier_barang'),
            'multiple' => false,
            'disabled' => (isset($relAttributes) && isset($relAttributes['id_supplier_barang'])),
        ]
    ]); ?>
    <div class="clearfix"></div>
</div>
<hr />
<div class="row">
    <div class="col-md-12 text-center">
        <?= Html::submitButton('<i class="fa fa-save"></i> Simpan', ['class' => 'btn btn-success']); ?>
        <?= Html::a('<i class="fa fa-chevron-left"></i> Kembali', ['contoh-produk/index'], ['class' => 'btn btn-default']) ?>
    </div>
</div>
<?php ActiveForm::end(); ?>