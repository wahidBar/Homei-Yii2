<?php

/**
 * Autogenerated From GII
 * modified by Defri Indra M
 * 2021
 */

use yii\helpers\Html;
use app\components\annex\ActiveForm;
use \app\components\annex\Tabs;
use kartik\depdrop\DepDrop;
use richardfan\widget\JSRegister;

/**
 * @var yii\web\View $this
 * @var app\models\IsianLanjutan $model
 * @var app\components\annex\ActiveForm $form
 */

?>
<?php
$setting = \app\models\SiteSetting::find()->all();
$this->registerCss("

.overlay {
    position:absolute;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.4);
}
");
?>
<!-- Navigation -->
<section class="navigation">
    <div class="parallax parallax--nav" style="background-image: url(<?= \Yii::$app->request->baseUrl . "/uploads/" . $setting[0]['gambar_header'] ?>);">
        <div class="overlay"></div>
        <div class="container clearfix">
            <div class="row">
                <div class="col-12">
                    <h2>
                        <?= $setting[0]['tagline']; ?>
                    </h2>
                </div>
                <div class="col-12">
                    <p>
                        <?= $setting[0]['tagline2']; ?>
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End Navigation -->
<!-- Contact content -->
<section class="contact-content">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="m-t-40">
                    <img src="<?= \Yii::$app->request->baseUrl . "/homepage/img/offers.jpg" ?>" alt="">
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-contact-wrap m-t-40">
                    <h4>Design Bangunan</h4>
                    <!-- display success message -->
                    <?php if (Yii::$app->session->hasFlash('success')) : ?>
                        <div class="alert alert-success alert-dismissable">
                            <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
                            <p><i class="icon fa fa-check"></i>Saved!</p>
                            <?= Yii::$app->session->getFlash('success') ?>
                        </div>
                    <?php endif; ?>

                    <!-- display error message -->
                    <?php if (Yii::$app->session->hasFlash('error')) : ?>
                        <div class="alert alert-danger alert-dismissable">
                            <button aria-hidden="true" data-dismiss="alert" class="close" type="button">×</button>
                            <h4><i class="icon fa fa-check"></i>Saved!</h4>
                            <?= Yii::$app->session->getFlash('error') ?>
                        </div>
                    <?php endif; ?>
                    <?php $form = ActiveForm::begin([
                        'id' => 'IsianLanjutan',
                        'layout' => 'horizontal',
                        'enableClientValidation' => true,
                        'errorSummaryCssClass' => 'error-summary alert alert-error',
                        'enableClientScript' => false,
                    ]);
                    ?>
                    <?php echo $form->errorSummary($model); ?>

                    <div class="row">
                        <div class="col-md-12 col-12">

                            <?php
                            $id = $_GET['id'];
                            if ($id) {
                                $design = app\models\MasterKonsepDesain::find()->where(['id' => $id])->one();
                                echo
                                $form->field($model, 'id_konsep_design', [
                                    'template' => '
                                        {label}
                                        {input}
                                        {error}
                                    ',
                                    'inputOptions' => [
                                        'class' => 'form-control'
                                    ],
                                    'labelOptions' => [
                                        'class' => 'control-label'
                                    ],
                                    'options' => ['tag' => false]
                                ])->textInput(['disabled' => true, 'value' => $design->nama_konsep]);
                            } else {
                                echo $form->field($model, 'id_konsep_design', [
                                    'template' => '
                                            {label}
                                            {input}
                                            {error}
                                        ',
                                    'inputOptions' => [
                                        'class' => ''
                                    ],
                                    'labelOptions' => [
                                        'class' => 'control-label'
                                    ],
                                ])->widget(\kartik\select2\Select2::classname(), [
                                    'name' => 'class_name',
                                    'model' => $model,
                                    'attribute' => 'id_konsep_design',
                                    'data' => \yii\helpers\ArrayHelper::map(app\models\MasterKonsepDesain::find()->all(), 'id', 'nama_konsep'),
                                    'options' => [
                                        'placeholder' => $model->getAttributeLabel('id_konsep_design'),
                                        'multiple' => false,
                                        'disabled' => (isset($relAttributes) && isset($relAttributes['id_konsep_design'])),
                                    ]
                                ]);
                            }
                            ?>
                        </div>
                        <div class="col-md-6 col-12">
                            <div class="form-group d-flex flex-column position-relative mb-4">
                                <label class="form-label" for="id_provinsi">Provinsi</label>
                                <select id="id_provinsi" name="id_provinsi" class="form-control select2">
                                    <option value="" selected>Pilih Provinsi</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6 col-12">
                            <div class="form-group d-flex flex-column position-relative mb-4">
                                <label class="form-label" for="id_kota">Kabupaten/Kota</label>
                                <select id="id_kota" name="id_kota" class="form-control select2">
                                    <option value="" selected>Pilih Kabupaten/Kota</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6 col-12">
                            <?= $form->field(
                                $model,
                                'panjang',
                                [
                                    'template' => '
                                        {label}
                                        {input}
                                        {error}
                                    ',
                                    'inputOptions' => [
                                        'class' => 'form-control'
                                    ],
                                    'labelOptions' => [
                                        'class' => 'control-label'
                                    ],
                                    'options' => ['tag' => false]
                                ]
                            )->textInput(['maxlength' => true]) ?>
                        </div>
                        <div class="col-md-6 col-12">
                            <?= $form->field(
                                $model,
                                'lebar',
                                [
                                    'template' => '
                                        {label}
                                        {input}
                                        {error}
                                    ',
                                    'inputOptions' => [
                                        'class' => 'form-control'
                                    ],
                                    'labelOptions' => [
                                        'class' => 'control-label'
                                    ],
                                    'options' => ['tag' => false]
                                ]
                            )->textInput(['maxlength' => true]) ?>
                        </div>
                        <div class="col-md-6 col-12">
                            <?=         // modified by Defri Indra
                            $form->field($model, 'id_satuan', [
                                'template' => '
                                    {label}
                                    {input}
                                    {error}
                                ',
                                'inputOptions' => [
                                    'class' => ''
                                ],
                                'labelOptions' => [
                                    'class' => 'control-label'
                                ],
                            ])->widget(\kartik\select2\Select2::classname(), [
                                'name' => 'class_name',
                                'model' => $model,
                                'attribute' => 'id_satuan',
                                'data' => \yii\helpers\ArrayHelper::map(app\models\MasterSatuan::find()->where(['jenis_satuan_id' => 3])->all(), 'id', 'nama'),
                                'options' => [
                                    'placeholder' => $model->getAttributeLabel('id_satuan'),
                                    'multiple' => false,
                                    'disabled' => (isset($relAttributes) && isset($relAttributes['id_satuan'])),
                                ]
                            ]); ?>
                        </div>
                        <div class="col-md-6 col-12">
                            <?= $form->field($model, 'budget', [
                                'template' => '
                                        {label}
                                        {input}
                                        {error}
                                    ',
                                'inputOptions' => [
                                    'class' => 'form-control'
                                ],
                                'labelOptions' => [
                                    'class' => 'control-label'
                                ],
                            ])->textInput(['maxlength' => true]) ?>
                        </div>
                        <div class="col-md-12 col-12">
                            <?= $form->field($model, 'keterangan', [
                                'template' => '
                                        {label}
                                        {input}
                                        {error}
                                    ',
                                'inputOptions' => [
                                    'class' => ''
                                ],
                                'labelOptions' => [
                                    'class' => 'control-label'
                                ],
                            ])->textarea(['rows' => 6]) ?>
                        </div>
                    </div>

                    <div class="clearfix"></div>
                </div>
                <hr />
                <div class="row">
                    <div class="col-md-offset-3 col-md-10">
                        <?= Html::submitButton('<i class="fa fa-save"></i> Simpan', ['class' => 'btn btn-success']); ?>
                        <?= Html::a('<i class="fa fa-chevron-left"></i> Kembali', ['index'], ['class' => 'btn btn-default']) ?>
                    </div>
                </div>
                <?php ActiveForm::end(); ?>
            </div>
        </div>
    </div>
    </div>
</section>
<!-- End Contact Content -->

<?php JSRegister::begin(); ?>
<script>
    $(document).ready(function() {
        $("#id_provinsi").select2({
            ajax: {
                url: '<?= \Yii::$app->request->BaseUrl ?>/home/getdataprov',
                type: "post",
                dataType: 'json',
                delay: 200,
                data: function(params) {
                    return {
                        searchTerm: params.term
                    };
                },
                processResults: function(response) {
                    return {
                        results: response
                    };
                },
                cache: true
            }
        });
    });

    // Kabupaten
    $("#id_provinsi").change(function() {
        var id_prov = $("#id_provinsi").val();
        $("#id_kota").select2({
            ajax: {
                url: '<?= \Yii::$app->request->BaseUrl ?>/home/getdatakab?id_prov=' + id_prov,
                type: "post",
                dataType: 'json',
                delay: 200,
                data: function(params) {
                    return {
                        searchTerm: params.term
                    };
                },
                processResults: function(response) {
                    return {
                        results: response
                    };
                },
                cache: true
            }
        });
    });
</script>
<?php JSRegister::end(); ?>
<?php
$this->registerJsFile("@web/homepage/vendor/jquery-3.2.1.min.js", ['position' => \yii\web\View::POS_END]);
?>